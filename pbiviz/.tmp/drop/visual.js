var qe5k6fz8g7ydw;(()=>{"use strict";var t={764:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Visual=void 0;var i=function(){function t(t){var e=this;this.data=[];var i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.display="flex",i.style.flexDirection="column",i.style.alignItems="center",i.style.justifyContent="center",this.button=document.createElement("button"),this.button.textContent="Gerar Relatório",this.button.disabled=!0,this.button.style.margin="10px 0",this.button.style.padding="6px 14px",this.button.style.fontSize="14px",this.button.onclick=function(){return e.sendRequest()},this.logDiv=document.createElement("div"),this.logDiv.style.width="90%",this.logDiv.style.height="150px",this.logDiv.style.overflowY="auto",this.logDiv.style.border="1px solid #ccc",this.logDiv.style.padding="8px",this.logDiv.style.fontSize="12px",this.logDiv.style.fontFamily="monospace",this.logDiv.style.backgroundColor="#f9f9f9",this.logDiv.style.whiteSpace="pre-wrap",this.logDiv.style.marginTop="10px",i.appendChild(this.button),i.appendChild(this.logDiv),t.element.appendChild(i)}return t.prototype.log=function(t){var e=(new Date).toLocaleTimeString();this.logDiv.textContent+="[".concat(e,"] ").concat(t,"\n"),this.logDiv.scrollTop=this.logDiv.scrollHeight},t.prototype.update=function(t){var e,i=null===(e=t.dataViews)||void 0===e?void 0:e[0];this.log("DataView recebido? ".concat(i?"Sim":"Não")),(null==i?void 0:i.table)?this.log("Tipo detectado: TABLE"):(null==i?void 0:i.categorical)?this.log("Tipo detectado: CATEGORICAL"):(null==i?void 0:i.matrix)?this.log("Tipo detectado: MATRIX"):this.log("Tipo de dataView desconhecido ou vazio");var o=null==i?void 0:i.table;if(!o||!o.rows||!o.columns)return this.log("Dados de tabela incompletos ou ausentes. Botão desabilitado."),void(this.button.disabled=!0);var a=o.columns.map(function(t){return t.displayName});this.data=o.rows.map(function(t){var e={};return t.forEach(function(t,i){e[a[i]]=t}),e}),this.log("Dados carregados: ".concat(this.data.length," linhas.")),this.button.disabled=0===this.data.length},t.prototype.sendRequest=function(){var t=this;console.log("Enviando dados...:",this.data),fetch("https://apcbrh-powerbi-report-app.azurewebsites.net/api/bi_castrolanda_single",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filtros:this.data})}).then(function(e){e.ok?(alert("Requisição enviada com sucesso."),t.log("Requisição enviada com sucesso.")):(alert("Erro ao enviar: ".concat(e.status)),t.log("Erro ao enviar: ".concat(e.status)))}).catch(function(e){alert("Falha na requisição: "+e.message),t.log("Falha na requisição: ".concat(e.message))})},t}();e.Visual=i}},e={};function i(o){var a=e[o];if(void 0!==a)return a.exports;var s=e[o]={exports:{}};return t[o](s,s.exports,i),s.exports}var o={};(()=>{var t=o;Object.defineProperty(t,"__esModule",{value:!0});var e=i(764),a=window.powerbi,s={name:"qe5k6fz8g7ydw",displayName:"Gerar Relatório",class:"Visual",apiVersion:"5.3.0",create:function(t){if(e.Visual)return new e.Visual(t);throw"Visual instance not found"},createModalDialog:function(t,e,i){var o=globalThis.dialogRegistry;t in o&&new o[t](e,i)},custom:!0};void 0!==a&&(a.visuals=a.visuals||{},a.visuals.plugins=a.visuals.plugins||{},a.visuals.plugins.qe5k6fz8g7ydw=s),t.default=s})(),qe5k6fz8g7ydw=o})();