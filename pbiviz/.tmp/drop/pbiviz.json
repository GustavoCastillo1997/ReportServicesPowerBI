{"visual":{"name":"BotaoEnviaAPI","displayName":"Botão Envia API","guid":"qe5k6fz8g7ydw","visualClassName":"Visual","version":"1.0.0.0","description":"Botão que envia filtros para API","supportUrl":"https://www.microsoft.com/power-bi","gitHubUrl":""},"author":{"name":"Gustavo Olmedo Scevola Castillo","email":"gustavoosc_@hotmail.com"},"apiVersion":"5.3.0","style":"style/visual.less","stringResources":{},"capabilities":{"dataRoles":[{"name":"dados","kind":"Grouping","displayName":"Filtros"}],"dataViewMappings":[{"table":{"rows":{"select":[{"for":{"in":"dados"}}]}}}],"objects":{},"privileges":[]},"content":{"js":"var qe5k6fz8g7ydw;(()=>{\"use strict\";var t={764:(t,e)=>{Object.defineProperty(e,\"__esModule\",{value:!0}),e.Visual=void 0;var i=function(){function t(t){var e=this;this.data=[];var i=document.createElement(\"div\");i.style.width=\"100%\",i.style.height=\"100%\",i.style.display=\"flex\",i.style.flexDirection=\"column\",i.style.alignItems=\"center\",i.style.justifyContent=\"center\",this.button=document.createElement(\"button\"),this.button.textContent=\"Gerar Relatório\",this.button.disabled=!0,this.button.style.margin=\"10px 0\",this.button.style.padding=\"6px 14px\",this.button.style.fontSize=\"14px\",this.button.onclick=function(){return e.sendRequest()},this.logDiv=document.createElement(\"div\"),this.logDiv.style.width=\"90%\",this.logDiv.style.height=\"150px\",this.logDiv.style.overflowY=\"auto\",this.logDiv.style.border=\"1px solid #ccc\",this.logDiv.style.padding=\"8px\",this.logDiv.style.fontSize=\"12px\",this.logDiv.style.fontFamily=\"monospace\",this.logDiv.style.backgroundColor=\"#f9f9f9\",this.logDiv.style.whiteSpace=\"pre-wrap\",this.logDiv.style.marginTop=\"10px\",i.appendChild(this.button),i.appendChild(this.logDiv),t.element.appendChild(i)}return t.prototype.log=function(t){var e=(new Date).toLocaleTimeString();this.logDiv.textContent+=\"[\".concat(e,\"] \").concat(t,\"\\n\"),this.logDiv.scrollTop=this.logDiv.scrollHeight},t.prototype.update=function(t){var e,i=null===(e=t.dataViews)||void 0===e?void 0:e[0];this.log(\"DataView recebido? \".concat(i?\"Sim\":\"Não\")),(null==i?void 0:i.table)?this.log(\"Tipo detectado: TABLE\"):(null==i?void 0:i.categorical)?this.log(\"Tipo detectado: CATEGORICAL\"):(null==i?void 0:i.matrix)?this.log(\"Tipo detectado: MATRIX\"):this.log(\"Tipo de dataView desconhecido ou vazio\");var o=null==i?void 0:i.table;if(!o||!o.rows||!o.columns)return this.log(\"Dados de tabela incompletos ou ausentes. Botão desabilitado.\"),void(this.button.disabled=!0);var a=o.columns.map(function(t){return t.displayName});this.data=o.rows.map(function(t){var e={};return t.forEach(function(t,i){e[a[i]]=t}),e}),this.log(\"Dados carregados: \".concat(this.data.length,\" linhas.\")),this.button.disabled=0===this.data.length},t.prototype.sendRequest=function(){var t=this;console.log(\"Enviando dados...:\",this.data),fetch(\"https://apcbrh-powerbi-report-app.azurewebsites.net/api/bi_castrolanda_single\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({filtros:this.data})}).then(function(e){e.ok?(alert(\"Requisição enviada com sucesso.\"),t.log(\"Requisição enviada com sucesso.\")):(alert(\"Erro ao enviar: \".concat(e.status)),t.log(\"Erro ao enviar: \".concat(e.status)))}).catch(function(e){alert(\"Falha na requisição: \"+e.message),t.log(\"Falha na requisição: \".concat(e.message))})},t}();e.Visual=i}},e={};function i(o){var a=e[o];if(void 0!==a)return a.exports;var s=e[o]={exports:{}};return t[o](s,s.exports,i),s.exports}var o={};(()=>{var t=o;Object.defineProperty(t,\"__esModule\",{value:!0});var e=i(764),a=window.powerbi,s={name:\"qe5k6fz8g7ydw\",displayName:\"Botão Envia API\",class:\"Visual\",apiVersion:\"5.3.0\",create:function(t){if(e.Visual)return new e.Visual(t);throw\"Visual instance not found\"},createModalDialog:function(t,e,i){var o=globalThis.dialogRegistry;t in o&&new o[t](e,i)},custom:!0};void 0!==a&&(a.visuals=a.visuals||{},a.visuals.plugins=a.visuals.plugins||{},a.visuals.plugins.qe5k6fz8g7ydw=s),t.default=s})(),qe5k6fz8g7ydw=o})();","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACcklEQVR4nGNgGAWjYBSMgmEJDOsNpfRqDX11aw0bdGsNN+vWGj5jGIzAvt6eRb9GX1uvxiBOt8Zwol6t0W69WsM3erVG/9HxQLuVQb3Uilev2thGt9YoDeRY3RrDI3o1ht+xOXbAPaBboSsIdmyNUb5ujdEi3Rqjq3o1Rn+JdeyAe0CPAofiwj7rA8jC3uv9jwxpD/isDyA99kY9UDsaA/8HXRJCBjCH4QOjHtBDCr3Obd0ooVO+qgpF3q7d6f+XH1/g8j07+gZXDBjWm/6/9eI23PC7r+7+N6gzgcsvPb4cLnfn5Z3/Rg1mg68YTZmfjhJCuUsKwOIevT7/f/7+CRb79+/f/+R5aYO3Hth7bT/cA5ceXwaLbbmwFS62+cKWwZ2Jvfp8//+AhjYIlKws///3318w+9P3T/8dO10Gtwf0ao3+zzowB27Jx28f4ez2LZ1Doxg1b7b+//LjSxTLrj+78d+gHpGpB20e0Ks1+m/VaofhgWfvn/03a7IaGh5YfXot3OGvP7+Bs2funz34k1Di3BRwUQkC3399/5+3tBBuIago9Z0QOHg9YNJo8f/uq3twC+YcnAcWP3r7GFzs2J0Tg9cDMw/MRil9bNscwOKhUyPgRSkIlK6sGHx5IGhy6P9ff37hbOvsvLwLJV+AMvqg8YBBncn/8w8vwB0IKoFMmyxRHTch4P+fv3/gahYfWzr4kpAehXjUAwMdA4OmItMb9UDAaAwMqSTkvd7/MMOIG9zFNbyuW2tkDJsLGNTD6+RMcOjVGnWAZmMG7QQHCYBRq95QRbfOOFS31rBNr8Zom16N4XNSDBgFo2AUjAKGIQEAkqNB3aFhJ4wAAAAASUVORK5CYII="},"visualEntryPoint":""}